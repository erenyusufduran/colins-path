# SQL

| <font size="4px">**Contents**</font>            |
| :---------------------------------------------- |
| 1. [***Advanced SQL Commands***](#commands)     |
| 2. [***Primary Keys and Foreign Keys***](#keys) |
| 3. [***Constraints***](#constraints)            |
| 4. [***CREATE Table***](#createTable)           |
| 5. [***INSERT Table***](#insertTable)           |
| 6. [***UPDATE Table***](#updateTable)           |
| 7. [***DELETE Table***](#deleteTable)           |
| 8. [***ALTER Table***](#alterTable)             |
| 9. [***DROP Table***](#dropTable)               |
| 10. [***CHECK Constraints***](#check)           |

## <a id="check">**CHECK Constraints**</a>

## <a id="commands">***Advenced SQL Commands***</a>

### **Timestamps and Extract**

- **TIME** - Contains only time
- **DATE** - Contains only date
- **TIMESTAMP** - Contains date and time
- **TIMESTAMPTZ** - Contains date, time and timezone

## <a id="keys">***Primary Keys and Foreign Keys***</a>

A primary key is a column or a group of columns used to identify a row uniquely in a table. Primary keys are also important since they allow us to easily discern what columns should be used for joining tables together.

A foreign key is a field or group of fields in a table that uniquely identifies a row in another table. A foreign key is defined in a table that references to the **primary key** of the other table.

The table that contains the foreign key is called refencing table or child table. The table to which the foreign key references is called referenced table or parent table.

When creating tables and defining columns, we can use constraints to define columns as being a primary key, or attaching a foreign key relationship to another table.

## <a id="constraints">**Constraints**</a>

- Contraints are the rules enforced on data columns on table.
- These are used to prevent invalid data from being entered into the database.
- This ensures the the accuracy and reliability of the data in the database.
  - **Column Constraints:** Constraints the data in a column to adhere to certain conditions.
  - **Table Constraints:** Applied to the entire table rather than to an individual column.

Most common contraints used; **NOT NULL**, **UNIQUE**, **PRIMARY KEY**, **FOREIGN KEY**, **CHECK**, **EXCLUSION**

## <a id="createTable">**CREATE Table**</a>

- **SERIAL** keyword:
  - In postgreSQL, a sequence is a special kind of database object that generates a sequence of integers.
  - A sequence is often used as the primary key column in a table.
  - It will create a sequence object and set the next value generated by the sequence as the default value for the column.
  - This is perfect for a primary key, because it logs unique integer entries for you automatically upon insertion.

```sql
CREATE TABLE account(
	user_id SERIAL PRIMARY KEY,
	username VARCHAR(30) UNIQUE NOT NULL,
	password VARCHAR(50) NOT NULL,
	email VARCHAR(100) UNIQUE NOT NULL,
	created_on TIMESTAMP NOT NULL,
	last_login TIMESTAMP
) -- This can be executed one time. Later on we will learn ALTERs.

CREATE TABLE job(
	job_id SERIAL PRIMARY KEY,
	job_name VARCHAR(150) UNIQUE NOT NULL
)
```

## <a id="insertTable">**INSERT Table**</a>

SERIAL columns do not need to be provided a value.

```sql
INSERT INTO account(username, password, email, created_on) 
VALUES
('Eren', 'password', 'erenydurann@gmail.com', CURRENT_TIMESTAMP)

INSERT INTO job(job_name)
VALUES
('Astronaut')

INSERT INTO job(job_name)
VALUES
('Astronaut')
```

## <a id="updateTable">**UPDATE Table**</a>

```sql
UPDATE account
SET last_login = CURRENT_TIMESTAMP

UPDATE account
SET last_login = created_on

UPDATE account_job
SET hire_date = account.created_on
FROM account
WHERE account_job.user_id = account.user_id

UPDATE account
SET last_login = CURRENT_TIMESTAMP
RETURNING email

UPDATE account
SET last_login = CURRENT_TIMESTAMP
RETURNING email, created_on, last_login
```

## <a id="deleteTable">**DELETE Table**</a>

```sql
DELETE FROM job WHERE job_name = 'President'
```

## <a id="alterTable">**ALTER Table**</a>

The `ALTER` clause allows for changes to an existing table structure, such as:
- Adding, dropping or renaming columns
- Changing a column's data type
- Set *DEFAULT* values for a column
- ADD *CHECK* constraints
- Rename table

```sql
CREATE TABLE information(
	info_id SERIAL PRIMARY KEY,
	title VARCHAR(100) NOT NULL,
	person VARCHAR(50) NOT NULL UNIQUE
)

ALTER TABLE information
RENAME TO new_info

ALTER TABLE new_info
RENAME COLUMN person TO people

ALTER TABLE new_info
ALTER COLUMN people DROP NOT NULL
```

## <a id="dropTable">**DROP Table**</a>

`DROP` allows for the complete removal of a column in a table.

```sql
ALTER TABLE new_info
DROP COLUMN IF EXISTS people
```

