# Setting up Fabric on Kubernetes (Google Cloud)

Two tools for setting up the fabric network and comminies clusters. `kubectl`, `minikube`

### kubectl

- CLI for running commands against the k8s cluster.
- Commands are executed on the shell prompt.

### Minikube - Utility for local development

- K8s cluster is setup in a single VM
- Used for local development & experimentation

### Setup Workflow

1. create image and push to the docker.hub
2. setup fabric with kubectl for setting up the peers and the orderer as ports as minicube clusters.
3. Once the containers for the orderer and the peers has started, application channel need to be created and peers need to join the application channel.

## Minikube & Kubectl Installation on Host Machine

- minikube start --memory=4096
- kubectl get all

---

- `k8s`
  - `init-setup.sh`
    - Generate the crypto
    - Setup fabric config objects
  - `clean-all.sh`
    - Deletes the objects generated by `init-setup.sh `

### Fabric on Kubernetes

- Peer & Orderer launched as Pods.
- Pod restart should not impact the Ledger | State database
- Peer & Orderer should get automatically restarted on failure
- Peer & Orderer IP/Hostnames exposed outside the cluster

- Peer & Orderer = Pod - 1, 4
- ReplicaSet - 1, 3, 4
- StatefulSet - 1, 2, 3, 4

### Fabric setup on Kubernetes

1. Prepare the Docker images (optional)
2. Setup the Kubernetes YAML
3. Launch the Orderer and Peer
4. Initialize the peer and test.
