# Fabric Setup on the Cloud

Target infrastructure on AWS will look like below.

We will have a VPC in which there will be three virtual machines are easy to instances, **first for the orderer**, **second and third for the Anchor peers for the Acme Organization** and **the Budget Organization**.

### Network Considerations

- VM must be reachable or file transfer & SSH. We will be using our host machine to connect with these cloud VMS.
- VM will connect over TCP with other VMs.
  - If all of the VMs are set up in the same VPC, then there is no problem.
  - If the VMs are set in different VPCs, then there will be need to configure the network path between the VMs on certain ports.
- Use of fabric tools from Remote machines will require the appropriate ports to be exposed.
  - For example, if you are using the peer binary, it would need access to port 7051 and 7052 on the peer VMs.
- _Open Security Group_
  - In production, it is not recommended.

---

- `cloud`
  - `artefacts` - Artifacts generated by scripts
  - `bins`
    - `orderer` - Shell scripts to be copied to orderer VM
    - `peer` - Shell scripts to be copied to peer VM
  - Shell scripts and configuration files

### Cloud Setup Tasks

1. Setup the _crypto material_
2. Setup the _cloud VM + Config Setup_
3. Setup the Orderer (type=solo)
4. Setup the _Peers_ (Acme)

## Crypto Setup

1. Fabric CA will be used generating the crypto.
2. Organization _may_ setup a (intermediate) certificate authority.
3. Admin's in the Orgs will be responsible for registration / enrollments.

## Setup the crypto material

1. Generate the crypto material using `cryptogen tool`
2. Seperate the crypto folders for the various orgs. `./gen-crypto.sh`
   - This script generates our files with crypto material under the artifact subfolder.
     - Create the Organization MSP to be used by `orgs-msp.tar`
     - Create the MSP for Orderer `orderer-msp.tar`
     - Create the MSP for Acme `acme-msp.tar`
     - Create the MSP for Budget `budget-msp.tar`
   - `orgs-msp.tar` file will be used for the duration of the **Genesis Block**, which will then be used for **setup of the Orderer**.
   - Other three tar files will be used for **setting up the local MSP for the organizations**.
